-#  This file is app/views/items/index.html.haml
%h2 All Lab Equipment

= form_tag items_path, :id => 'categories_form', :method => :get do
  -#= select_tag("categories[]", options_for_select(Category.all.pluck(:name)) )
  -#Include:
  Categories:
  = select_tag(:cat, options_for_select(["All"] + Category.all.pluck(:name)) ) 
  = submit_tag 'Refresh', :id => 'categories_submit'

%table#items.table.table-striped.col-md-12
  %thead
    %tr
      %th
      %th{:class => @category_header}= link_to 'Equipment Category', items_path(:sort_by => 'category'), :id => 'category_header'
      %th{:class => @name_header}= link_to 'Name', items_path(:sort_by => 'name'), :id => 'name_header'
      %th Quantity
      %th Purchase Link

  %tbody
    - @items.each do |item|

      %tr
        - if get_item_quantity(item.name) < 5
          %td= raw("&#x2757")
          - flash[:notice] = "#{item.name} is at low quantity."
        - else
          %td
        %td= item.category
        %td= link_to "#{item.name}", item_path(item)
        %td= get_item_quantity(item.name)
        %td= link_to item.purchase_link, "http://#{item.purchase_link}", target: :_blank

= link_to 'Add new item', new_item_path

= render partial: 'paginate', locals: { resources: @items }
